<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Treasure Hunter RPG - Top-Down Enhanced</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0f0f0f, #1a1a1a);
            color: #fff;
            overflow: hidden;
            height: 100vh;
            user-select: none;
        }

        .game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
        }

        /* Enhanced Game World */
        .game-world {
            flex: 1;
            position: relative;
            overflow: hidden;
            background: #2d4a2d;
        }

        .world-map {
            position: absolute;
            width: 4000px;
            height: 3000px;
            background: 
                radial-gradient(circle at 20% 20%, #228b22 0%, #32cd32 10%, #6b8e23 20%, #8fbc8f 30%, #9acd32 40%, #228b22 50%, #2e8b57 60%, #3cb371 100%),
                repeating-linear-gradient(0deg, rgba(0,0,0,0.1) 0px, transparent 50px, rgba(0,0,0,0.1) 100px);
            transition: transform 0.3s ease;
        }

        /* Enhanced Zone System */
        .map-zone {
            position: absolute;
            border: 4px solid rgba(255, 255, 255, 0.4);
            border-radius: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 20px;
            color: rgba(255, 255, 255, 0.95);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
            transition: all 0.4s ease;
            cursor: pointer;
            z-index: 10;
        }

        .map-zone:hover {
            transform: scale(1.05);
            border-color: rgba(255, 215, 0, 0.8);
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.6);
        }

        /* Zone definitions with enhanced styling */
        .zone-newbie {
            background: linear-gradient(135deg, rgba(50, 205, 50, 0.7), rgba(34, 139, 34, 0.5));
            width: 500px;
            height: 400px;
            top: 100px;
            left: 100px;
        }

        .zone-forest {
            background: linear-gradient(135deg, rgba(34, 139, 34, 0.7), rgba(0, 100, 0, 0.5));
            width: 600px;
            height: 500px;
            top: 200px;
            left: 700px;
        }

        .zone-mountain {
            background: linear-gradient(135deg, rgba(105, 105, 105, 0.7), rgba(169, 169, 169, 0.5));
            width: 700px;
            height: 500px;
            top: 150px;
            left: 1500px;
        }

        .zone-desert {
            background: linear-gradient(135deg, rgba(238, 203, 173, 0.7), rgba(222, 184, 135, 0.5));
            width: 650px;
            height: 450px;
            top: 800px;
            left: 400px;
        }

        .zone-frozen {
            background: linear-gradient(135deg, rgba(173, 216, 230, 0.7), rgba(135, 206, 235, 0.5));
            width: 550px;
            height: 400px;
            top: 400px;
            left: 2400px;
        }

        .zone-volcano {
            background: linear-gradient(135deg, rgba(255, 69, 0, 0.7), rgba(255, 140, 0, 0.5));
            width: 500px;
            height: 450px;
            top: 1500px;
            left: 2200px;
            animation: volcanoGlow 3s ease-in-out infinite;
        }

        .zone-dungeon {
            background: linear-gradient(135deg, rgba(25, 25, 112, 0.7), rgba(72, 61, 139, 0.5));
            width: 450px;
            height: 350px;
            top: 1000px;
            left: 1200px;
        }

        .zone-demon-realm {
            background: linear-gradient(135deg, rgba(139, 0, 139, 0.8), rgba(75, 0, 130, 0.6));
            width: 700px;
            height: 600px;
            top: 2200px;
            left: 1500px;
            border-color: #ff00ff;
            animation: demonGlow 2s ease-in-out infinite;
        }

        /* Enhanced Player Character */
        .player-character {
            position: absolute;
            width: 80px;
            height: 80px;
            border: 5px solid #ffd700;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            z-index: 200;
            transition: all 0.2s ease;
            cursor: move;
            top: 300px;
            left: 300px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
        }

        .player-character.moving {
            animation: playerMove 0.5s ease-in-out infinite alternate;
        }

        @keyframes playerMove {
            0% { transform: scale(1) rotate(-2deg); }
            100% { transform: scale(1.05) rotate(2deg); }
        }

        /* Enhanced Power Level Display */
        .power-level-display {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: bold;
            border: 3px solid #ffd700;
            box-shadow: 0 0 20px rgba(255, 107, 53, 0.6);
            white-space: nowrap;
            animation: powerFloat 2s ease-in-out infinite;
        }

        @keyframes powerFloat {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-5px); }
        }

        /* Enhanced Pet System */
        .pet {
            position: absolute;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ff9800, #f57c00);
            border: 4px solid #ffeb3b;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            z-index: 190;
            cursor: pointer;
            top: 320px;
            left: 220px;
            transition: all 0.3s ease;
            animation: petFloat 3s ease-in-out infinite;
        }

        .pet.evolved {
            transform: scale(1.3);
            border-color: #ff6b35;
            animation: petEvolved 2s ease-in-out infinite;
        }

        @keyframes petEvolved {
            0%, 100% { 
                box-shadow: 0 0 25px rgba(255, 107, 53, 0.8);
                transform: scale(1.3);
            }
            50% { 
                box-shadow: 0 0 45px rgba(255, 107, 53, 1);
                transform: scale(1.35);
            }
        }

        /* Enhanced Monster System */
        .monster {
            position: absolute;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        .monster:hover {
            transform: scale(1.2);
            filter: brightness(1.3);
        }

        /* World Boss - Enhanced */
        .world-boss {
            position: absolute;
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, #8b0000, #ff0000);
            border: 8px solid #ffd700;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            cursor: pointer;
            z-index: 120;
            animation: worldBossFloat 4s ease-in-out infinite;
            top: 1800px;
            left: 1800px;
        }

        @keyframes worldBossFloat {
            0%, 100% { 
                transform: scale(1) rotate(0deg);
                box-shadow: 0 0 50px rgba(255, 0, 0, 0.8);
            }
            25% { 
                transform: scale(1.1) rotate(2deg);
                box-shadow: 0 0 80px rgba(255, 0, 0, 1);
            }
            50% { 
                transform: scale(1.15) rotate(0deg);
                box-shadow: 0 0 100px rgba(255, 0, 0, 1.2);
            }
            75% { 
                transform: scale(1.1) rotate(-2deg);
                box-shadow: 0 0 80px rgba(255, 0, 0, 1);
            }
        }

        /* World Boss Timer */
        .boss-timer {
            position: absolute;
            top: -80px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #8b0000, #ff0000);
            border: 4px solid #ffd700;
            border-radius: 15px;
            padding: 10px 20px;
            font-size: 18px;
            font-weight: bold;
            color: white;
            animation: timerBlink 1s ease-in-out infinite;
            white-space: nowrap;
        }

        @keyframes timerBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Enhanced Loot Drops */
        .loot-drop {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            z-index: 150;
            animation: lootFloat 2s ease-in-out infinite;
        }

        .loot-drop.common {
            background: linear-gradient(135deg, #888, #666);
            border: 3px solid #aaa;
        }

        .loot-drop.rare {
            background: linear-gradient(135deg, #0070dd, #004499);
            border: 3px solid #42a5f5;
            animation: lootFloat 2s ease-in-out infinite, rareGlow 1.5s ease-in-out infinite;
        }

        .loot-drop.legendary {
            background: linear-gradient(135deg, #ff8000, #cc6600);
            border: 3px solid #ffb347;
            animation: lootFloat 2s ease-in-out infinite, legendaryGlow 1s ease-in-out infinite;
        }

        @keyframes lootFloat {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.1); }
        }

        @keyframes rareGlow {
            0%, 100% { box-shadow: 0 0 15px rgba(66, 165, 245, 0.6); }
            50% { box-shadow: 0 0 30px rgba(66, 165, 245, 1); }
        }

        @keyframes legendaryGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 179, 71, 0.8); }
            50% { box-shadow: 0 0 40px rgba(255, 179, 71, 1.2); }
        }

        /* Enhanced UI Panel */
        .ui-panel {
            width: 420px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(20, 20, 20, 0.9));
            border-left: 4px solid #d4af37;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            box-shadow: -8px 0 25px rgba(0, 0, 0, 0.6);
        }

        .panel-header {
            background: linear-gradient(135deg, #d4af37, #b8860b);
            color: #000;
            padding: 20px;
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            border-bottom: 3px solid #ffd700;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }

        .player-info-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .class-indicator {
            font-size: 32px;
        }

        .player-stats-header {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .power-display {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            font-size: 16px;
            border: 2px solid #ffd700;
            animation: powerPulse 2s ease-in-out infinite;
        }

        @keyframes powerPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .vip-display {
            background: linear-gradient(135deg, #9c27b0, #7b1fa2);
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            color: white;
            border: 2px solid #ba68c8;
        }

        /* Enhanced Equipment Section */
        .equipment-section {
            padding: 20px;
            border-bottom: 2px solid #333;
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            color: #d4af37;
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 2px solid #444;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .equipment-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .equipment-slot {
            aspect-ratio: 1;
            background: linear-gradient(135deg, rgba(30, 30, 30, 0.9), rgba(50, 50, 50, 0.7));
            border: 3px solid #666;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            font-size: 32px;
        }

        .equipment-slot:hover {
            border-color: #d4af37;
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.4);
        }

        .enhance-level {
            position: absolute;
            top: -8px;
            right: -8px;
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            border: 3px solid #ffd700;
            box-shadow: 0 0 15px rgba(255, 107, 53, 0.6);
        }

        /* Enhancement Panel */
        .enhancement-panel {
            background: linear-gradient(135deg, #2d1b69, #11998e);
            border: 3px solid #ffd700;
            border-radius: 15px;
            padding: 20px;
            margin-top: 15px;
        }

        .protection-items {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .protection-item {
            background: rgba(0,0,0,0.5);
            border: 2px solid #4caf50;
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .protection-item:hover {
            border-color: #ffd700;
            transform: scale(1.05);
        }

        .protection-item.active {
            background: rgba(76,175,80,0.3);
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(76,175,80,0.6);
        }

        .enhance-button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 12px;
            border: 3px solid #ffd700;
        }

        .enhance-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255,107,53,0.6);
        }

        .success-rate {
            text-align: center;
            font-size: 14px;
            color: #ffd700;
            font-weight: bold;
        }

        /* Daily Progress */
        .daily-progress {
            padding: 20px;
            border-bottom: 2px solid #333;
        }

        .day-counter {
            background: linear-gradient(135deg, #4caf50, #45a049);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            border: 3px solid #66bb6a;
        }

        .daily-tasks {
            list-style: none;
        }

        .daily-task {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #333;
            font-size: 14px;
        }

        .task-completed {
            color: #4caf50;
            font-size: 18px;
        }

        .task-incomplete {
            color: #ff9800;
            font-size: 18px;
        }

        /* Chat System */
        .chat-section {
            padding: 20px;
        }

        .chat-window {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #555;
            border-radius: 12px;
            height: 200px;
            overflow-y: auto;
            padding: 15px;
            font-size: 13px;
            margin-bottom: 15px;
        }

        .chat-message {
            margin-bottom: 6px;
            padding: 6px 10px;
            border-radius: 8px;
            word-wrap: break-word;
            line-height: 1.5;
            animation: messageSlide 0.3s ease-out;
        }

        .chat-message.system {
            color: #ffd700;
            background: rgba(255, 215, 0, 0.1);
            border-left: 4px solid #ffd700;
        }

        .chat-message.loot {
            color: #ff6b35;
            background: rgba(255, 107, 53, 0.1);
            border-left: 4px solid #ff6b35;
            font-weight: bold;
        }

        .chat-message.world {
            color: #ff0040;
            background: rgba(255, 0, 64, 0.1);
            border-left: 4px solid #ff0040;
            font-weight: bold;
        }

        /* Minimap Enhanced */
        .minimap {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 300px;
            height: 220px;
            background: rgba(0, 0, 0, 0.85);
            border: 4px solid #d4af37;
            border-radius: 15px;
            z-index: 1000;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6);
        }

        .minimap-content {
            width: 100%;
            height: 100%;
            position: relative;
            background: linear-gradient(45deg, #1a3d1a 0%, #2d4a2d 50%, #1a3d1a 100%);
        }

        .minimap-player {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #ff6b35;
            border: 3px solid #ffd700;
            border-radius: 50%;
            z-index: 10;
            animation: minimapPulse 2s ease-in-out infinite;
        }

        .minimap-boss {
            position: absolute;
            width: 16px;
            height: 16px;
            background: #ff0000;
            border: 2px solid #ffd700;
            border-radius: 50%;
            animation: bossBlip 1s ease-in-out infinite;
        }

        @keyframes minimapPulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 8px rgba(255, 107, 53, 0.8);
            }
            50% { 
                transform: scale(1.3);
                box-shadow: 0 0 15px rgba(255, 107, 53, 1);
            }
        }

        @keyframes bossBlip {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Floating Damage Numbers */
        .damage-number {
            position: absolute;
            font-weight: bold;
            font-size: 24px;
            pointer-events: none;
            z-index: 1000;
            animation: damageFloat 2.5s ease-out forwards;
        }

        .damage-number.normal {
            color: #ffffff;
            text-shadow: 2px 2px 4px #000;
        }

        .damage-number.crit {
            color: #ff6b35;
            font-size: 32px;
            text-shadow: 0 0 10px #ff6b35;
        }

        .damage-number.heal {
            color: #4caf50;
            font-size: 28px;
            text-shadow: 0 0 8px #4caf50;
        }

        @keyframes damageFloat {
            0% { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
            20% { 
                transform: translateY(-20px) scale(1.2); 
            }
            100% { 
                opacity: 0; 
                transform: translateY(-100px) scale(0.8); 
            }
        }

        /* PvP Indicator */
        .pvp-indicator {
            position: absolute;
            top: 100px;
            right: 340px;
            background: linear-gradient(135deg, #9c27b0, #7b1fa2);
            border: 3px solid #ba68c8;
            border-radius: 15px;
            padding: 15px 20px;
            font-weight: bold;
            text-align: center;
            animation: pvpGlow 2s ease-in-out infinite;
        }

        @keyframes pvpGlow {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(156, 39, 176, 0.6);
            }
            50% { 
                box-shadow: 0 0 40px rgba(156, 39, 176, 1);
            }
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0a0a, #1a1a2e);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 5000;
        }

        .loading-title {
            font-size: 48px;
            color: #d4af37;
            margin-bottom: 40px;
            text-shadow: 0 0 30px #d4af37;
            animation: loadingGlow 2s ease-in-out infinite;
        }

        .loading-progress {
            width: 600px;
            height: 30px;
            background: rgba(40, 40, 40, 0.8);
            border: 4px solid #d4af37;
            border-radius: 20px;
            overflow: hidden;
        }

        .loading-bar {
            height: 100%;
            background: linear-gradient(90deg, #d4af37, #ffd700, #ff6b35);
            width: 0%;
            transition: width 0.3s ease;
            animation: progressShine 2s linear infinite;
        }

        @keyframes loadingGlow {
            0%, 100% { text-shadow: 0 0 30px #d4af37; }
            50% { text-shadow: 0 0 50px #ffd700, 0 0 80px #d4af37; }
        }

        @keyframes progressShine {
            0% { box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.2); }
            50% { box-shadow: inset 0 0 40px rgba(255, 255, 255, 0.4); }
            100% { box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.2); }
        }

        /* Responsive Design */
        @media (max-width: 1400px) {
            .ui-panel { width: 380px; }
            .minimap { width: 280px; height: 200px; }
        }

        @media (max-width: 1200px) {
            .ui-panel { width: 350px; }
            .minimap { width: 250px; height: 180px; }
        }

        @media (max-width: 768px) {
            .game-container { flex-direction: column; }
            .ui-panel {
                width: 100%;
                height: 300px;
                border-left: none;
                border-top: 4px solid #d4af37;
            }
            .minimap { width: 200px; height: 150px; }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-title">⚔️ TREASURE HUNTER RPG ⚔️</div>
        <div class="loading-progress">
            <div class="loading-bar" id="loadingBar"></div>
        </div>
        <div style="margin-top: 30px; font-size: 18px; color: #ccc;" id="loadingText">
            Đang khởi tạo thế giới...
        </div>
    </div>

    <div class="game-container" id="gameContainer" style="display: none;">
        <!-- Game World -->
        <div class="game-world" id="gameWorld">
            <div class="world-map" id="worldMap">
                <!-- Enhanced Zones -->
                <div class="map-zone zone-newbie" onclick="enterZone('newbie')">
                    🌱 Khu Vực Tân Thủ<br><small>(Lv.1-5)</small>
                </div>
                <div class="map-zone zone-forest" onclick="enterZone('forest')">
                    🌲 Rừng Sâu<br><small>(Lv.5-10)</small>
                </div>
                <div class="map-zone zone-mountain" onclick="enterZone('mountain')">
                    ⛰️ Núi Cao<br><small>(Lv.10-15)</small>
                </div>
                <div class="map-zone zone-desert" onclick="enterZone('desert')">
                    🏜️ Sa Mạc<br><small>(Lv.15-20)</small>
                </div>
                <div class="map-zone zone-frozen" onclick="enterZone('frozen')">
                    ❄️ Vùng Băng Giá<br><small>(Lv.20-25)</small>
                </div>
                <div class="map-zone zone-volcano" onclick="enterZone('volcano')">
                    🌋 Núi Lửa<br><small>(Lv.25-30)</small>
                </div>
                <div class="map-zone zone-dungeon" onclick="enterZone('dungeon')">
                    🕳️ Hầm Ngục<br><small>(Lv.15-25)</small>
                </div>
                <div class="map-zone zone-demon-realm" onclick="enterZone('demon-realm')">
                    👹 Ma Giới<br><small>(Lv.40-50)</small>
                </div>
                
                <!-- Player Character -->
                <div class="player-character" id="player">
                    🧙‍♂️
                    <div class="power-level-display" id="powerDisplay">
                        🔥 15,847 LC
                    </div>
                </div>
                
                <!-- Pet -->
                <div class="pet" id="pet">🐉</div>
                
                <!-- World Boss -->
                <div class="world-boss" id="worldBoss" onclick="attackWorldBoss()">
                    🐲
                    <div class="boss-timer" id="bossTimer">
                        Next Spawn: 02:34:21
                    </div>
                </div>
                
                <!-- Sample Monsters -->
                <div class="monster" style="top: 400px; left: 400px; width: 50px; height: 50px; background: linear-gradient(135deg, #8b4513, #a0522d); border: 3px solid #cd853f; font-size: 24px;" onclick="attackMonster(this)">
                    👹
                </div>
                <div class="monster" style="top: 600px; left: 800px; width: 60px; height: 60px; background: linear-gradient(135deg, #696969, #808080); border: 3px solid #a9a9a9; font-size: 28px;" onclick="attackMonster(this)">
                    👺
                </div>
                <div class="monster" style="top: 1200px; left: 1600px; width: 80px; height: 80px; background: linear-gradient(135deg, #9932cc, #8a2be2); border: 4px solid #da70d6; font-size: 36px;" onclick="attackMonster(this)">
                    👿
                </div>
                
                <!-- Sample Loot Drops -->
                <div class="loot-drop rare" style="top: 500px; left: 600px;" onclick="collectLoot(this)">💎</div>
                <div class="loot-drop legendary" style="top: 800px; left: 1200px;" onclick="collectLoot(this)">⚔️</div>
                <div class="loot-drop common" style="top: 900px; left: 400px;" onclick="collectLoot(this)">🧪</div>
            </div>
            
            <!-- Enhanced Minimap -->
            <div class="minimap">
                <div class="minimap-content" id="minimapContent">
                    <div class="minimap-player" id="minimapPlayer"></div>
                    <div class="minimap-boss" id="minimapBoss" style="top: 60%; left: 45%;"></div>
                </div>
            </div>
            
            <!-- PvP Indicator -->
            <div class="pvp-indicator">
                ⚔️ Arena Rank: #15<br>
                <small>Power: 15,847</small>
            </div>
        </div>

        <!-- Enhanced UI Panel -->
        <div class="ui-panel">
            <!-- Header with Power Level -->
            <div class="panel-header">
                <div class="player-info-header">
                    <div class="class-indicator">🧙‍♂️</div>
                    <div>
                        <div style="font-size: 20px; font-weight: bold;">DragonSlayer</div>
                        <div style="font-size: 14px; opacity: 0.8;">Pháp Sư Cấp 45</div>
                    </div>
                </div>
                
                <div class="player-stats-header">
                    <div class="power-display">
                        🔥 Lực Chiến<br>15,847
                    </div>
                    <div class="vip-display">
                        👑 VIP 7<br>Active
                    </div>
                </div>
            </div>
            
            <!-- Equipment Section -->
            <div class="equipment-section">
                <div class="section-title">
                    ⚔️ Trang Bị Thần Khí
                </div>
                
                <div class="equipment-grid">
                    <div class="equipment-slot legendary" title="Kiếm Rồng Lửa +12" onclick="showEquipmentInfo(this)">
                        ⚔️
                        <div class="enhance-level">+12</div>
                    </div>
                    <div class="equipment-slot mythic" title="Giáp Thần Long +15" onclick="showEquipmentInfo(this)">
                        🛡️
                        <div class="enhance-level">+15</div>
                    </div>
                    <div class="equipment-slot legendary" title="Nhẫn Phượng Hoàng +8" onclick="showEquipmentInfo(this)">
                        💍
                        <div class="enhance-level">+8</div>
                    </div>
                    <div class="equipment-slot rare" title="Mũ Phép +5" onclick="showEquipmentInfo(this)">
                        🎩
                        <div class="enhance-level">+5</div>
                    </div>
                    <div class="equipment-slot legendary" title="Giày Bay +10" onclick="showEquipmentInfo(this)">
                        👢
                        <div class="enhance-level">+10</div>
                    </div>
                    <div class="equipment-slot epic" title="Vòng Cổ Sấm Sét +7" onclick="showEquipmentInfo(this)">
                        📿
                        <div class="enhance-level">+7</div>
                    </div>
                </div>

                <!-- Enhancement Panel -->
                <div class="enhancement-panel">
                    <div class="section-title" style="color: white; border-color: #ffd700;">
                        🔨 Cường Hóa Trang Bị
                    </div>
                    
                    <div class="protection-items">
                        <div class="protection-item active" onclick="selectProtection(this)">
                            🛡️<br>Hộ Phù +15%
                        </div>
                        <div class="protection-item" onclick="selectProtection(this)">
                            ✨<br>Hộ Phù +25%
                        </div>
                    </div>
                    
                    <button class="enhance-button" onclick="enhanceEquipment()">
                        🔥 CƯỜNG HÓA (+12 → +13)
                    </button>
                    
                    <div class="success-rate">
                        ⚠️ Tỷ lệ thành công: 45% (+15% từ Hộ Phù)
                    </div>
                </div>
            </div>

            <!-- Daily Progress -->
            <div class="daily-progress">
                <div class="section-title">📅 Tiến Trình 30 Ngày</div>
                
                <div class="day-counter">
                    Ngày 18/30 - Giai đoạn PvP
                </div>
                
                <ul class="daily-tasks">
                    <li class="daily-task">
                        <span>🐲 Săn World Boss (5/5)</span>
                        <span class="task-completed">✅</span>
                    </li>
                    <li class="daily-task">
                        <span>🔨 Cường hóa đồ (3/3)</span>
                        <span class="task-completed">✅</span>
                    </li>
                    <li class="daily-task">
                        <span>⚔️ Arena PvP (2/5)</span>
                        <span class="task-incomplete">⏳</span>
                    </li>
                    <li class="daily-task">
                        <span>🏰 Bang chiến (0/1)</span>
                        <span class="task-incomplete">⏳</span>
                    </li>
                    <li class="daily-task">
                        <span>🐾 Pet hóa hình (1/1)</span>
                        <span class="task-completed">✅</span>
                    </li>
                </ul>
            </div>

            <!-- Chat System -->
            <div class="chat-section">
                <div class="section-title">💬 Chat Thế Giới</div>
                
                <div class="chat-window" id="chatWindow">
                    <div class="chat-message system">🎮 Chào mừng đến Treasure Hunter Enhanced!</div>
                    <div class="chat-message world">🔥 [World Boss] Dragon King xuất hiện tại Ma Giới!</div>
                    <div class="chat-message loot">💰 [MasterSword] nhận được: Thần Khí Rồng Lửa +15!</div>
                    <div class="chat-message system">⚔️ Bang chiến bắt đầu sau 10 phút!</div>
                    <div class="chat-message loot">🎯 [DragonSlayer] cường hóa thành công +12!</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced Game State for Top-Down RPG
        const gameState = {
            player: {
                x: 300,
                y: 300,
                level: 45,
                powerLevel: 15847,
                vipLevel: 7,
                class: 'mage',
                name: 'DragonSlayer',
                isMoving: false,
                targetX: null,
                targetY: null
            },
            
            world: {
                offsetX: 0,
                offsetY: 0,
                currentZone: 'newbie',
                monsters: [],
                lootDrops: [],
                bossSpawnTimer: 9261, // seconds
            },
            
            enhancement: {
                selectedProtection: '+15%',
                protectionActive: true,
                currentItem: 'Kiếm Rồng Lửa',
                currentLevel: 12
            },
            
            dailyProgress: {
                currentDay: 18,
                totalDays: 30,
                tasks: {
                    worldBoss: { completed: 5, required: 5 },
                    enhance: { completed: 3, required: 3 },
                    arena: { completed: 2, required: 5 },
                    guildWar: { completed: 0, required: 1 },
                    petEvolution: { completed: 1, required: 1 }
                }
            }
        };

        // Initialize Enhanced Game
        function initGame() {
            console.log('🎮 Khởi tạo Treasure Hunter RPG Enhanced...');
            showLoadingScreen();
        }

        function showLoadingScreen() {
            const loadingScreen = document.getElementById('loadingScreen');
            const loadingBar = document.getElementById('loadingBar');
            const loadingText = document.getElementById('loadingText');
            
            const loadingSteps = [
                'Đang khởi tạo thế giới...',
                'Tạo monsters và boss...',
                'Tải trang bị thần khí...',
                'Chuẩn bị hệ thống PvP...',
                'Kết nối server...',
                'Hoàn tất!'
            ];
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 16.67;
                loadingBar.style.width = progress + '%';
                
                const stepIndex = Math.floor(progress / 16.67);
                if (stepIndex < loadingSteps.length) {
                    loadingText.textContent = loadingSteps[stepIndex];
                }
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                        document.getElementById('gameContainer').style.display = 'flex';
                        startGame();
                    }, 500);
                }
            }, 200);
        }

        function startGame() {
            console.log('🎯 Game Started!');
            
            // Initialize game systems
            setupControls();
            updateMinimap();
            startTimers();
            addInitialChatMessages();
            
            // Start game loop
            gameLoop();
            
            showNotification('🎉 Chào mừng trở lại Treasure Hunter! Hãy chinh phục server!', 'success');
        }

        function setupControls() {
            // Click to move
            document.getElementById('worldMap').addEventListener('click', (e) => {
                const rect = e.currentTarget.getBoundingClientRect();
                const x = e.clientX - rect.left + Math.abs(gameState.world.offsetX);
                const y = e.clientY - rect.top + Math.abs(gameState.world.offsetY);
                
                movePlayerTo(x, y);
            });

            // WASD movement
            document.addEventListener('keydown', (e) => {
                const speed = 20;
                switch(e.key.toLowerCase()) {
                    case 'w':
                        gameState.player.y = Math.max(50, gameState.player.y - speed);
                        break;
                    case 's':
                        gameState.player.y = Math.min(2950, gameState.player.y + speed);
                        break;
                    case 'a':
                        gameState.player.x = Math.max(50, gameState.player.x - speed);
                        break;
                    case 'd':
                        gameState.player.x = Math.min(3950, gameState.player.x + speed);
                        break;
                }
                updatePlayerPosition();
                updateCamera();
                updateMinimap();
            });
        }

        function movePlayerTo(targetX, targetY) {
            gameState.player.targetX = targetX;
            gameState.player.targetY = targetY;
            gameState.player.isMoving = true;
            
            document.getElementById('player').classList.add('moving');
        }

        function updatePlayerMovement() {
            if (!gameState.player.isMoving) return;
            
            const dx = gameState.player.targetX - gameState.player.x;
            const dy = gameState.player.targetY - gameState.player.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance < 5) {
                gameState.player.isMoving = false;
                document.getElementById('player').classList.remove('moving');
                return;
            }
            
            const speed = 3;
            gameState.player.x += (dx / distance) * speed;
            gameState.player.y += (dy / distance) * speed;
            
            updatePlayerPosition();
            updateCamera();
            updateMinimap();
        }

        function updatePlayerPosition() {
            const player = document.getElementById('player');
            player.style.left = gameState.player.x + 'px';
            player.style.top = gameState.player.y + 'px';
            
            // Update pet position
            const pet = document.getElementById('pet');
            pet.style.left = (gameState.player.x - 80) + 'px';
            pet.style.top = (gameState.player.y + 40) + 'px';
        }

        function updateCamera() {
            const gameWorld = document.getElementById('gameWorld');
            const worldRect = gameWorld.getBoundingClientRect();
            const worldMap = document.getElementById('worldMap');
            
            // Center camera on player
            const offsetX = -gameState.player.x + worldRect.width / 2;
            const offsetY = -gameState.player.y + worldRect.height / 2;
            
            // Constrain camera bounds
            const maxOffsetX = 0;
            const minOffsetX = worldRect.width - 4000;
            const maxOffsetY = 0;
            const minOffsetY = worldRect.height - 3000;
            
            gameState.world.offsetX = Math.max(minOffsetX, Math.min(maxOffsetX, offsetX));
            gameState.world.offsetY = Math.max(minOffsetY, Math.min(maxOffsetY, offsetY));
            
            worldMap.style.transform = `translate(${gameState.world.offsetX}px, ${gameState.world.offsetY}px)`;
        }

        function updateMinimap() {
            const minimapPlayer = document.getElementById('minimapPlayer');
            const mapWidth = 4000;
            const mapHeight = 3000;
            const minimapWidth = 300;
            const minimapHeight = 220;
            
            const x = (gameState.player.x / mapWidth) * minimapWidth;
            const y = (gameState.player.y / mapHeight) * minimapHeight;
            
            minimapPlayer.style.left = x + 'px';
            minimapPlayer.style.top = y + 'px';
        }

        // Enhanced Equipment System
        function enhanceEquipment() {
            const successRate = gameState.enhancement.selectedProtection === '+25%' ? 0.70 : 0.60;
            const isSuccess = Math.random() < successRate;
            
            // Add enhancement animation
            const equipmentSlot = document.querySelector('.equipment-slot.legendary');
            equipmentSlot.style.animation = 'enhanceGlow 1s ease-in-out';
            
            setTimeout(() => {
                equipmentSlot.style.animation = '';
                
                if (isSuccess) {
                    gameState.enhancement.currentLevel++;
                    gameState.player.powerLevel += 500;
                    
                    // Update display
                    const enhanceLevel = equipmentSlot.querySelector('.enhance-level');
                    enhanceLevel.textContent = '+' + gameState.enhancement.currentLevel;
                    
                    const powerDisplay = document.getElementById('powerDisplay');
                    powerDisplay.innerHTML = `🔥 ${gameState.player.powerLevel.toLocaleString()} LC`;
                    
                    const headerPower = document.querySelector('.power-display');
                    headerPower.innerHTML = `🔥 Lực Chiến<br>${gameState.player.powerLevel.toLocaleString()}`;
                    
                    showNotification('🎉 CƯỜNG HÓA THÀNH CÔNG! +' + gameState.enhancement.currentLevel + ' ĐẠT ĐƯỢC!', 'success');
                    showDamageNumber(gameState.player.x, gameState.player.y, '+500 LC', 'crit');
                    addChatMessage('loot', `🔥 [${gameState.player.name}] cường hóa thành công +${gameState.enhancement.currentLevel}!`);
                    
                    // Update daily progress
                    gameState.dailyProgress.tasks.enhance.completed++;
                    updateDailyProgress();
                    
                } else {
                    showNotification('💥 Cường hóa thất bại! Hộ phù đã bảo vệ trang bị.', 'warning');
                    addChatMessage('system', `⚠️ [${gameState.player.name}] cường hóa thất bại nhưng đã được bảo vệ!`);
                }
            }, 1000);
        }

        function selectProtection(element) {
            document.querySelectorAll('.protection-item').forEach(item => {
                item.classList.remove('active');
            });
            element.classList.add('active');
            
            gameState.enhancement.selectedProtection = element.textContent.includes('+25%') ? '+25%' : '+15%';
            
            // Update success rate display
            const successRate = gameState.enhancement.selectedProtection === '+25%' ? '70%' : '60%';
            document.querySelector('.success-rate').innerHTML = 
                `⚠️ Tỷ lệ thành công: ${successRate} (${gameState.enhancement.selectedProtection} từ Hộ Phù)`;
            
            showNotification(`🛡️ Đã chọn: Hộ Phù ${gameState.enhancement.selectedProtection}`, 'info');
        }

        // Combat System
        function attackMonster(monster) {
            const damage = Math.floor(Math.random() * 2000) + 1000;
            const isCrit = Math.random() < 0.3;
            const finalDamage = isCrit ? Math.floor(damage * 1.5) : damage;
            
            showDamageNumber(
                parseInt(monster.style.left) + 25, 
                parseInt(monster.style.top) + 25, 
                finalDamage, 
                isCrit ? 'crit' : 'normal'
            );
            
            // Monster death animation
            monster.style.animation = 'monsterDeath 0.5s ease-out forwards';
            
            setTimeout(() => {
                monster.remove();
                
                // Drop loot
                const lootTypes = ['💎', '⚔️', '🧪', '💰', '📿'];
                const lootIcon = lootTypes[Math.floor(Math.random() * lootTypes.length)];
                createLootDrop(
                    parseInt(monster.style.left) + 25,
                    parseInt(monster.style.top) + 25,
                    lootIcon
                );
                
                // Add exp and update power
                const expGain = Math.floor(Math.random() * 100) + 50;
                gameState.player.powerLevel += 10;
                updatePowerDisplay();
                
                showNotification(`💀 Tiêu diệt quái vật! +${expGain} EXP`, 'success');
                addChatMessage('system', `⚔️ [${gameState.player.name}] tiêu diệt quái vật, nhận ${expGain} EXP!`);
                
            }, 500);
        }

        function attackWorldBoss() {
            const damage = Math.floor(Math.random() * 5000) + 2000;
            showDamageNumber(1875, 1875, damage, 'crit');
            
            const worldBoss = document.getElementById('worldBoss');
            worldBoss.style.animation = 'bossAttack 0.8s ease-in-out';
            
            setTimeout(() => {
                worldBoss.style.animation = '';
            }, 800);
            
            showNotification(`🐲 Tấn công World Boss! Damage: ${damage.toLocaleString()}!`, 'success');
            addChatMessage('world', `🔥 [${gameState.player.name}] tấn công World Boss gây ${damage.toLocaleString()} sát thương!`);
            
            // Update daily progress
            gameState.dailyProgress.tasks.worldBoss.completed++;
            updateDailyProgress();
            
            // Random legendary loot
            if (Math.random() < 0.1) {
                setTimeout(() => {
                    createLootDrop(1900, 1900, '⚔️', 'legendary');
                    showNotification('🎉 LEGENDARY DROP: Thần Khí Rồng Lửa!', 'legendary');
                    addChatMessage('loot', `💎 [${gameState.player.name}] nhận được: Thần Khí Rồng Lửa từ World Boss!`);
                }, 1000);
            }
        }

        function createLootDrop(x, y, icon, rarity = 'common') {
            const loot = document.createElement('div');
            loot.className = `loot-drop ${rarity}`;
            loot.style.left = x + 'px';
            loot.style.top = y + 'px';
            loot.textContent = icon;
            loot.onclick = () => collectLoot(loot);
            
            document.getElementById('worldMap').appendChild(loot);
            
            // Auto-collect after 30 seconds
            setTimeout(() => {
                if (loot.parentNode) {
                    loot.remove();
                }
            }, 30000);
        }

        function collectLoot(loot) {
            const icon = loot.textContent;
            const rarity = loot.classList.contains('legendary') ? 'LEGENDARY' : 
                          loot.classList.contains('rare') ? 'RARE' : 'COMMON';
            
            showDamageNumber(
                parseInt(loot.style.left) + 20,
                parseInt(loot.style.top) + 20,
                'LOOT!',
                'heal'
            );
            
            loot.style.animation = 'lootCollect 0.5s ease-out forwards';
            
            setTimeout(() => {
                loot.remove();
                showNotification(`💰 Thu thập: ${rarity} ${icon}`, 'loot');
                addChatMessage('loot', `💎 [${gameState.player.name}] thu thập được ${rarity} ${icon}!`);
            }, 500);
        }

        // Utility Functions
        function showDamageNumber(x, y, text, type) {
            const damage = document.createElement('div');
            damage.className = `damage-number ${type}`;
            damage.textContent = text;
            damage.style.left = x + 'px';
            damage.style.top = y + 'px';
            
            document.getElementById('worldMap').appendChild(damage);
            
            setTimeout(() => {
                damage.remove();
            }, 2500);
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                border-radius: 12px;
                color: white;
                font-weight: bold;
                z-index: 3000;
                animation: slideIn 0.5s ease-out, slideOut 0.5s ease-out 4s forwards;
                max-width: 400px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.8);
                border: 3px solid;
            `;
            
            switch(type) {
                case 'success':
                    notification.style.background = 'linear-gradient(135deg, #4caf50, #45a049)';
                    notification.style.borderColor = '#66bb6a';
                    break;
                case 'warning':
                    notification.style.background = 'linear-gradient(135deg, #ff9800, #f57c00)';
                    notification.style.borderColor = '#ffb74d';
                    break;
                case 'info':
                    notification.style.background = 'linear-gradient(135deg, #2196f3, #1976d2)';
                    notification.style.borderColor = '#42a5f5';
                    break;
                case 'loot':
                    notification.style.background = 'linear-gradient(135deg, #9c27b0, #7b1fa2)';
                    notification.style.borderColor = '#ba68c8';
                    break;
                case 'legendary':
                    notification.style.background = 'linear-gradient(135deg, #ff8000, #cc6600)';
                    notification.style.borderColor = '#ffb347';
                    notification.style.animation += ', legendaryPulse 0.5s ease-in-out infinite';
                    break;
            }
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 4500);
        }

        function addChatMessage(type, message) {
            const chatWindow = document.getElementById('chatWindow');
            const messageElement = document.createElement('div');
            messageElement.className = `chat-message ${type}`;
            messageElement.textContent = message;
            
            chatWindow.appendChild(messageElement);
            chatWindow.scrollTop = chatWindow.scrollHeight;
            
            // Keep only last 50 messages
            while (chatWindow.children.length > 50) {
                chatWindow.removeChild(chatWindow.firstChild);
            }
        }

        function updatePowerDisplay() {
            const powerDisplay = document.getElementById('powerDisplay');
            powerDisplay.innerHTML = `🔥 ${gameState.player.powerLevel.toLocaleString()} LC`;
            
            const headerPower = document.querySelector('.power-display');
            headerPower.innerHTML = `🔥 Lực Chiến<br>${gameState.player.powerLevel.toLocaleString()}`;
        }

        function updateDailyProgress() {
            // Update task display
            const tasks = document.querySelectorAll('.daily-task');
            const progress = gameState.dailyProgress.tasks;
            
            // Update world boss
            if (tasks[0]) {
                tasks[0].querySelector('span').textContent = 
                    `🐲 Săn World Boss (${progress.worldBoss.completed}/${progress.worldBoss.required})`;
                if (progress.worldBoss.complete
